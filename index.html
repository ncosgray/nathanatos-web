<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nathanatos Software</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.9.0/d3.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.14.9/cdn.min.js" defer></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
  <style>
    /* Custom styles */
    .app-icon {
      font-size: 2rem;
    }
    @media (max-width: 640px) {
      .app-icon {
        font-size: 1.5rem;
      }
    }
    .link {
      transition: all 0.2s ease;
    }
    .link:hover {
      color: #4299e1;
    }
    .privacy-list {
      margin-bottom: 20px;
    }
  
    /* Smooth transitions */
    .page-transition {
      transition: opacity 0.3s ease-in-out;
    }
    .app-card {
      transition: all 0.3s ease;
    }
    
    /* KoL data */
    .section-card {
      transition: all 0.3s ease;
    }
    .badge-wrapper {
      display: inline-flex;
      align-items: center;
    }
    .badge-wrapper:hover img {
      transform: scale(1.05);
    }
    .badge-wrapper img {
      transition: transform 0.2s ease;
    }

    /* Dark mode styles */
    .dark {
      background-color: #1a202c;
      color: #f7fafc;
    }
    .dark .bg-white {
      background-color: #2d3748;
    }
    .dark .text-gray-900 {
      color: #f7fafc;
    }
    .dark .text-gray-600 {
      color: #cbd5e0;
    }
    .dark .border-gray-100 {
      border-color: #4a5568;
    }
    
    /* App store badges */
    .store-badge {
      height: 40px;
      max-width: 165px;
    }
    .store-badge:hover img {
      transform: scale(1.05);
    }
    .store-badge img {
      transition: transform 0.2s ease;
    }

    /* D3 chart styles */
    .line {
      fill: none;
      stroke: firebrick;
      stroke-width: 2;
    }
    .overlay {
      fill: none;
      pointer-events: all;
    }
    .dot {
      fill: darkred;
      stroke: #fff;
    }
    .item-marker {
      fill: #ff6b6b;
      cursor: pointer;
    }
    .item-region {
      opacity: 0.2;
      cursor: pointer;
    }
    .item-region.color-a {
      fill: #2196f3; /* IOTM = blue */
    }
    .item-region.color-a.familiar {
      fill: #4caf50; /* FOTM = green */
    }
    .item-region.color-b {
      fill: #1565c0; /* Darker blue for alternating months/items */
    }
    .item-region.color-b.familiar {
      fill: #2e7d32; /* Darker green for alternating months/items */
    }
    .item-label {
      font-size: 9px;
      pointer-events: none;
      fill: #333;
    }
    .dark .item-label {
      fill: #eee;
    }
    .item-label tspan {
      dominant-baseline: text-before-edge;
    }
    .tooltip {
      position: absolute;
      padding: 10px;
      background: rgba(0, 0, 0, 0.8);
      color: #fff;
      border-radius: 5px;
      pointer-events: none;
      font-size: 14px;
      opacity: 0;
    }
    .grid line {
      stroke: lightgrey;
      stroke-opacity: 0.7;
      shape-rendering: crispEdges;
    }
    .grid path {
      stroke-width: 0;
    }
    .loading {
      text-align: center;
      font-style: italic;
      color: #666;
      padding: 20px;
    }
    .error {
      text-align: center;
      color: #d9534f;
      padding: 20px;
    }
    .exchange-dot {
      background-color: steelblue;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 5px;
      vertical-align: middle;
    }
    .zoom-controls {
      text-align: center;
      margin: 10px 10px;
    }
    .dark .zoom-btn {
      background-color: #2f2f2f;
      color: white;
    }
    .zoom-btn {
      background-color: #f0f0f0;
      color: black;
      border: 1px solid #ddd;
      padding: 6px 12px;
      margin: 9px 3px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: background-color 0.2s;
    }
    .zoom-btn:hover {
      background-color: #e0e0e0;
    }
    .zoom-btn.active {
      background-color: darkslategray;
      color: white;
      border-color: darkgray;
    }
    .axis-label {
      font-size: 12px;
      fill: #333;
      font-weight: bold;
    }
    .dark .axis-label {
      fill: white;
    }
</style>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JXDKVW0Z1R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JXDKVW0Z1R');
</script>
<body class="min-h-screen flex flex-col" :class="{'bg-gray-50 text-gray-900': !darkMode, 'bg-gray-900 text-white': darkMode}">
  <div x-data="{ 
      page: 'home', 
      darkMode: localStorage.getItem('darkMode') === 'true' || 
        (localStorage.getItem('darkMode') === null && window.matchMedia('(prefers-color-scheme: dark)').matches), 
      mobileMenuOpen: false, 
      kolAPIData: { loading: true, error: null, rates: [] },
      apps: [
        {
          name: 'Cuppa',
          description: 'A simple tea timer app for Android and iOS built with Flutter.',
          icon: '<img src=\'/software/images/Cuppa_hires_default.png\'>',
          github: 'https://github.com/ncosgray/cuppa_mobile',
          platforms: ['iOS', 'Android'],
          appStore: 'https://apps.apple.com/us/app/cuppa-tea-timer/id1241458171',
          fdroid: 'https://f-droid.org/en/packages/com.nathanatos.Cuppa/',
          playStore: 'https://play.google.com/store/apps/details?id=com.nathanatos.Cuppa'
        },
        {
          name: 'Cuppa for Mac',
          description: 'Cuppa is a small application for macOS to time your cup of tea as it steeps.',
          icon: '<img src=\'/software/images/cuppa_mac_icon.png\'>',
          github: 'https://github.com/ncosgray/cuppa_mac',
          platforms: ['macOS'],
          macStore: 'https://apps.apple.com/us/app/cuppa-tea-timer/id1297865739?mt=12'
        },
        {
          name: 'Biorhythmmm',
          description: 'An interactive graph of your biorhythm cycles.',
          icon: '<img src=\'/software/images/biorhythmmm_icon.png\'>',
          github: 'https://github.com/ncosgray/biorhythmmm',
          platforms: ['iOS', 'Android'],
          appStore: 'https://apps.apple.com/us/app/biorhythmmm/id6737791240',
          playStore: 'https://play.google.com/store/apps/details?id=com.nathanatos.biorhythmmm'
        },
        {
          name: 'EuchrePal',
          description: 'Keep track of your Euchre game using your phone.',
          icon: '<img src=\'/software/images/euchrepal_icon.png\'>',
          github: 'https://github.com/ncosgray/euchrepal',
          platforms: ['iOS', 'Android'],
          appStore: 'https://apps.apple.com/us/app/euchrepal/id1663582165',
          playStore: 'https://play.google.com/store/apps/details?id=com.nathanatos.euchrepal'
        }
      ]
    }" 
    x-init="
      // Dark mode toggle
      $watch('darkMode', value => {
        localStorage.setItem('darkMode', value);
        if (value) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
      });
      
      // Initialize dark mode based on saved preference or device settings
      if (darkMode) {
        document.documentElement.classList.add('dark');
      }

      // Fetch KoL data
      const APIUrl = 'https://4hea44d1a5.execute-api.us-east-1.amazonaws.com/getrate';
      fetch(APIUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          // Current exchange rate data
          kolAPIData.rate = `${data['rate'].toLocaleString()} Meat`;
          kolAPIData.iotm = `${data['iotm_is_familiar'] ? 'FOTM': 'IOTM'}: ${data['iotm_name']}`;
          kolAPIData.rate = `${data['rate'].toLocaleString()} Meat`;
          kolAPIData.timestamp = `as of ${data['now']} UTC`;
          kolAPIData.loading = false;

          // Fetch yesterday's exchange rate data, if available
          const date = new Date(data['now']);
          if (!isNaN(date.getTime())) {
            // Calculate yesterday's date
            date.setDate(date.getDate() - 1);
            const yesterdayYear = date.getFullYear();
            const yesterdayMonth = (date.getMonth() + 1).toString().padStart(2, '0');
            const yesterdayDay = date.getDate().toString().padStart(2, '0');

            // Get from API
            fetch(`${APIUrl}?date=${yesterdayYear}${yesterdayMonth}${yesterdayDay}`)
              .then(yesterdayResponse => {
                if (!yesterdayResponse.ok) {
                  throw new Error('Network response for yesterday was not ok');
                }
                return yesterdayResponse.json();
              })
              .then(yesterdayData => {
                // Calculate trend
                kolAPIData.delta = data['rate'] - yesterdayData['rate'];
                kolAPIData.deltaPercent = ((kolAPIData.delta / yesterdayData['rate']) * 100).toFixed(2) + '%';
                kolAPIData.trend = kolAPIData.delta > 0 ? 'up' : (kolAPIData.delta < 0 ? 'down' : 'flat');
              });
          }
  
        })
        .catch(error => {
          kolAPIData.loading = false;
          console.error('Error fetching data:', error);
        });

      // Check URL hash on page load
      const hash = window.location.hash.substring(1);
      if (hash && ['home', 'privacy', 'contact'].includes(hash)) {
        page = hash;
      }
      
      // Listen for hash changes
      window.addEventListener('hashchange', () => {
        const newHash = window.location.hash.substring(1);
        if (newHash && ['home', 'privacy', 'contact'].includes(newHash)) {
          page = newHash;
        }
      });
      
      // Watch for page changes to update the URL
      $watch('page', (value) => {
        window.location.hash = value;
      });
    ">
  
    <!-- Header -->
    <header class="shadow-sm sticky top-0 z-10" :class="{'bg-white': !darkMode, 'bg-gray-800 text-white': darkMode}">
      <div class="container mx-auto px-4 py-3 flex justify-between items-center">
        <a href="#" @click="page = 'home'" class="font-bold text-xl" :class="{'text-blue-600': !darkMode, 'text-blue-400': darkMode}">Nathanatos</a>
        
        <!-- Desktop Navigation -->
        <nav class="hidden md:flex space-x-6 items-center">
          <a href="#" @click="page = 'home'" class="transition-colors" 
             :class="{ 'text-blue-600 font-medium': page === 'home' && !darkMode, 'text-blue-400 font-medium': page === 'home' && darkMode, 'hover:text-blue-600': !darkMode, 'hover:text-blue-400': darkMode }">Home</a>
          <a href="#privacy" @click="page = 'privacy'" class="transition-colors" 
             :class="{ 'text-blue-600 font-medium': page === 'privacy' && !darkMode, 'text-blue-400 font-medium': page === 'privacy' && darkMode, 'hover:text-blue-600': !darkMode, 'hover:text-blue-400': darkMode }">Privacy</a>
          <a href="#contact" @click="page = 'contact'" class="transition-colors" 
             :class="{ 'text-blue-600 font-medium': page === 'contact' && !darkMode, 'text-blue-400 font-medium': page === 'contact' && darkMode, 'hover:text-blue-600': !darkMode, 'hover:text-blue-400': darkMode }">Contact</a>
          <button @click="darkMode = !darkMode" class="focus:outline-none p-2 rounded-full transition-colors" :class="{'bg-gray-100 hover:bg-gray-200': !darkMode, 'bg-gray-700 hover:bg-gray-600': darkMode}">
            <span x-show="!darkMode">üåô</span>
            <span x-show="darkMode">‚òÄÔ∏è</span>
          </button>
        </nav>
        
        <!-- Mobile Menu Button -->
        <button @click="mobileMenuOpen = !mobileMenuOpen" class="md:hidden focus:outline-none p-2 rounded-md transition-colors" :class="{'hover:bg-gray-100': !darkMode, 'hover:bg-gray-700': darkMode}">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
      
      <!-- Mobile Navigation -->
      <div x-show="mobileMenuOpen" class="md:hidden border-t" :class="{'bg-white border-gray-100': !darkMode, 'bg-gray-800 text-white border-gray-700': darkMode}" 
           x-transition:enter="transition ease-out duration-200"
           x-transition:enter-start="opacity-0 transform -translate-y-2"
           x-transition:enter-end="opacity-100 transform translate-y-0"
           x-transition:leave="transition ease-in duration-150"
           x-transition:leave-start="opacity-100 transform translate-y-0"
           x-transition:leave-end="opacity-0 transform -translate-y-2">
        <div class="container mx-auto px-4 py-2 flex flex-col space-y-2">
          <a href="#" @click="page = 'home'; mobileMenuOpen = false" class="py-2 transition-colors" 
             :class="{ 'text-blue-600 font-medium': page === 'home' && !darkMode, 'text-blue-400 font-medium': page === 'home' && darkMode, 'hover:text-blue-600': !darkMode, 'hover:text-blue-400': darkMode }">Home</a>
          <a href="#privacy" @click="page = 'privacy'; mobileMenuOpen = false" class="py-2 transition-colors" 
             :class="{ 'text-blue-600 font-medium': page === 'privacy' && !darkMode, 'text-blue-400 font-medium': page === 'privacy' && darkMode, 'hover:text-blue-600': !darkMode, 'hover:text-blue-400': darkMode }">Privacy</a>
          <a href="#contact" @click="page = 'contact'; mobileMenuOpen = false" class="py-2 transition-colors" 
             :class="{ 'text-blue-600 font-medium': page === 'contact' && !darkMode, 'text-blue-400 font-medium': page === 'contact' && darkMode, 'hover:text-blue-600': !darkMode, 'hover:text-blue-400': darkMode }">Contact</a>
          <button @click="darkMode = !darkMode" class="focus:outline-none text-left py-2 flex items-center">
            <span x-show="!darkMode" class="flex items-center"><span class="mr-2">üåô</span> Dark Mode</span>
            <span x-show="darkMode" class="flex items-center"><span class="mr-2">‚òÄÔ∏è</span> Light Mode</span>
          </button>
        </div>
      </div>
    </header>
    
    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-6">
      <!-- Home Page -->
      <div x-show="page === 'home'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="page-transition">
        <!-- Hero Section -->
        <section class="mb-12 py-6 md:py-12 text-center max-w-4xl mx-auto">
          <h1 class="text-3xl md:text-4xl font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">Nathanatos Software</h1>
          <p class="text-lg md:text-xl mb-6 max-w-2xl mx-auto" :class="{'text-gray-600': !darkMode, 'text-gray-300': darkMode}">Open-source projects by Nathan Cosgray</p>
          <div class="flex flex-col sm:flex-row justify-center gap-4 sm:gap-6">
            <a href="#apps" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition duration-300 font-medium shadow-sm hover:shadow">Apps</a>
            <a href="#kol" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition duration-300 font-medium shadow-sm hover:shadow">KoL Data</a>
            <a href="https://github.com/ncosgray" target="_blank" class="bg-gray-800 hover:bg-gray-900 text-white px-6 py-3 rounded-lg transition duration-300 font-medium shadow-sm hover:shadow">GitHub Profile</a>
          </div>
        </section>
        
        <!-- Apps Grid -->
        <section id="apps" class="mb-12 scroll-mt-16">
          <h2 class="text-2xl font-bold mb-8 text-center" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">Apps</h2>
          <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <template x-for="app in apps" :key="app.name">
              <div class="rounded-xl shadow-sm overflow-hidden app-card" :class="{'bg-white border border-gray-100': !darkMode, 'bg-gray-800 border border-gray-700': darkMode}">
                <div class="p-6">
                  <a :href="app.github" target="_blank" class="app-icon mb-3 p-3 rounded-full w-24 h-24 flex items-center justify-center transform hover:scale-105 transition-transform" :class="{'bg-blue-50': !darkMode, 'bg-blue-900/30': darkMode}" x-html="app.icon"></a>
                  <h3 class="text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}" x-text="app.name"></h3>
                  <div class="flex flex-wrap gap-2 mb-4">
                    <template x-for="platform in app.platforms" :key="platform">
                      <span class="px-2 py-1 rounded-full text-xs font-medium" :class="{'bg-blue-50 text-blue-700': !darkMode, 'bg-blue-900/30 text-blue-300': darkMode}" x-text="platform"></span>
                    </template>
                    <p class="mt-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}" x-text="app.description"></p>
                  </div>
                  
                  <!-- Store badges -->
                  <div class="flex flex-wrap gap-2 mb-4">
                    <template x-if="app.appStore">
                      <a :href="app.appStore" target="_blank" class="inline-block" :class="hover:opacity-90 transition-opacity">
                        <img src="/software/images/ios-app-store-badge.png" alt="Download on the App Store" class="store-badge transform hover:scale-105 transition-transform"/>
                      </a>
                    </template>
                    <template x-if="app.macStore">
                      <a :href="app.macStore" target="_blank" class="inline-block" :class="hover:opacity-90 transition-opacity">
                        <img src="/software/images/mac-app-store-badge.png" alt="Download on the Mac App Store" class="store-badge transform hover:scale-105 transition-transform" />
                      </a>
                    </template>
                    <template x-if="app.playStore">
                      <a :href="app.playStore" target="_blank" class="inline-block" :class="hover:opacity-90 transition-opacity">
                        <img src="/software/images/google-play-badge.png" alt="Get it on Google Play" class="store-badge transform hover:scale-105 transition-transform" />
                      </a>
                    </template>
                    <template x-if="app.fdroid">
                      <a :href="app.fdroid" target="_blank" class="inline-block" :class="hover:opacity-90 transition-opacity">
                        <img src="/software/images/fdroid-badge.png" alt="Get it on F-Droid" class="store-badge transform hover:scale-105 transition-transform" />
                      </a>
                    </template>
                  </div>
                  
                  <a :href="app.github" target="_blank" class="inline-flex items-center text-sm font-medium transition-colors link" :class="{'text-blue-600 hover:text-blue-700': !darkMode, 'text-blue-400 hover:text-blue-300': darkMode}">
                    <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                    View on GitHub
                  </a>
                </div>
              </div>
            </template>
          </div>
        </section>
        
        <!-- Kingdom of Loathing Data -->
        <section id="kol" class="mb-12 scroll-mt-16">
          <h2 class="text-2xl font-bold mb-8 text-center" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">Kingdom of Loathing Data</h2>
          <div class="max-w-3xl mx-auto">
            <div class="rounded-xl shadow-sm p-6 md:p-8" :class="{'bg-white border border-gray-100': !darkMode, 'bg-gray-800 border border-gray-700': darkMode}">
              <!-- Loading state -->
              <div x-show="kolAPIData.loading" class="flex justify-center items-center p-8">
                <svg class="animate-spin -ml-1 mr-3 h-8 w-8" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <span class="text-lg">Loading exchange rate...</span>
              </div>
              
              <!-- Data display -->
              <div class="mb-8 justify-center items-center">
                <div class="min-w-full flex flex-col sm:flex-row divide-y sm:divide-y-0" :class="{'divide-gray-200': !darkMode, 'divide-gray-700': darkMode}">
                  <!-- Logo -->
                  <div class="flex items-center justify-center py-3 sm:pr-4 sm:w-1/3">
                    <span class="flex items-center text-sm" :class="{'text-gray-600': !darkMode, 'text-gray-300': darkMode}">
                      <img :src="darkMode ? '/images/widget_image_dark.png' : '/images/widget_image.png'" class="mr-2" border=0 alt="Widget Logo"/>
                      <span>An Economist is You!</span>
                    </span>
                  </div>                    

                  <!-- Current rate, trend, and timestamp -->
                  <div class="flex-1 py-3 sm:pl-4">
                    <div x-show="!kolAPIData.loading">

                      <div class="flex items-center">
                        <!-- Exchange rate -->
                        <div class="text-2xl font-bold mr-2" :class="{'text-gray-800': !darkMode, 'text-white': darkMode}" x-text="'$1 US = ' + (kolAPIData.rate || '???')"></div>
                        
                        <!-- Trend up -->
                        <div x-show="kolAPIData.trend === 'up'" class="flex items-center">
                          <div class="flex items-center px-1.5 py-0.5 rounded-full bg-green-100">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-0.5 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                            </svg>
                            <span class="text-xs font-medium text-green-500" x-text="kolAPIData.deltaPercent"></span>
                          </div>
                        </div>

                        <!-- Trend down -->
                        <div x-show="kolAPIData.trend === 'down'" class="flex items-center">
                          <div class="flex items-center px-1.5 py-0.5 rounded-full bg-red-100">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-0.5 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 17h8m0 0v-8m0 8l-8-8-4 4-6-6" />
                            </svg>
                            <span class="text-xs font-medium text-red-500" x-text="kolAPIData.deltaPercent"></span>
                          </div>
                        </div>

                        <!-- Trend flat -->
                        <div x-show="kolAPIData.trend === 'flat'" class="flex items-center">
                          <div class="flex items-center px-1.5 py-0.5 rounded-full bg-gray-100">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 mr-0.5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14" />
                            </svg>
                            <span class="text-xs font-medium text-gray-500" x-text="kolAPIData.deltaPercent"></span>
                          </div>
                        </div>
                      </div>
                      
                      <!-- IOTM and timestamp -->
                      <div x-show="kolAPIData.timestamp">
                        <div class="flex items-center">
                          <span class="font-medium" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}" x-text="kolAPIData.iotm"></span>
                        </div>
                        <div class="mt-1 text-sm italic flex items-center" :class="{'text-gray-500': !darkMode, 'text-gray-400': darkMode}">
                          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" :class="{'text-gray-500': !darkMode, 'text-gray-400': darkMode}" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                          </svg>
                          <span x-text="kolAPIData.timestamp"></span>
                        </div>
                      </div>

                    </div>
                  </div>
                </div>
              </div>

              <!-- Rate history data graph -->
              <div>
                <div id="chart">
                  <div class="loading">Loading graph...</div>
                </div>
                <div class="zoom-controls">
                  <button class="zoom-btn" data-months="1">1 Month</button>
                  <button class="zoom-btn active" data-months="3">3 Months</button>
                  <button class="zoom-btn" data-months="6">6 Months</button>
                  <button class="zoom-btn" data-months="12">1 Year</button>
                  <button class="zoom-btn" data-months="24">2 Years</button>
                  <button class="zoom-btn" data-months="60">5 Years</button>
                  <button class="zoom-btn" data-months="120">10 Years</button>
                  <button class="zoom-btn" data-months="180">15 Years</button>
                  <button class="zoom-btn" data-months="all">All Data</button>
                </div>
              </div>

              <div class="mb-8 space-y-6" :class="{'text-gray-800': !darkMode, 'text-gray-200': darkMode}">
                <!-- Methodology Section -->
                <div class="section-card rounded-xl p-6" :class="{'bg-white': !darkMode, 'bg-gray-800': darkMode}">
                  <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd"></path>
                    </svg>
                    Methodology
                  </h3>
                  <p class="leading-relaxed" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">
                    As the only direct financial link between 
                    <a href="https://www.kingdomofloathing.com" target="_blank" rel="noopener noreferrer" class="font-medium underline link" :class="{'text-blue-600': !darkMode, 'text-blue-400': darkMode}">The Kingdom of Loathing</a>
                    and a real-world economy, the Mr. Accessory (an in-game item received in return for donating $10 to the game maintainers) is the perfect indicator by which to measure the current exchange rate. These items are commonly used to amass great in-game wealth; players donate to receive a Mr. A and then sell it in the mall for millions of Meat. The KoL exchange rate can therefore be calculated by finding the current asking price for a Mr. A and dividing this value by 10 to find the $1 conversion factor.
                  </p>
                </div>

                <!-- More Data Section -->
                <div class="section-card rounded-xl p-6" :class="{'bg-white': !darkMode, 'bg-gray-800': darkMode}">
                  <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm2 10a1 1 0 10-2 0v3a1 1 0 102 0v-3zm2-3a1 1 0 011 1v5a1 1 0 11-2 0v-5a1 1 0 011-1zm4-1a1 1 0 10-2 0v7a1 1 0 102 0V8z" clip-rule="evenodd"></path>
                    </svg>
                    More Data
                  </h3>
                  
                  <!-- CSV Data -->
                  <div class="mb-4 bg-gray-50 p-4 rounded-lg" :class="{'bg-gray-50': !darkMode, 'bg-gray-700': darkMode}">
                    <p class="font-medium mb-2" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">Raw CSV data files:</p>
                    <ul class="ml-5 space-y-2">
                      <li>
                        <a href="https://kol-exchange-web.s3.us-east-1.amazonaws.com/mr_accessory_rate_history.csv" target="_blank" rel="noopener noreferrer" class="flex items-center link" :class="{'text-blue-600 hover:text-blue-700': !darkMode, 'text-blue-400 hover:text-blue-300': darkMode}">
                          <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                          </svg>
                          Exchange Rate History
                        </a>
                      </li>
                      <li>
                        <a href="https://kol-exchange-web.s3.us-east-1.amazonaws.com/iotm_history.csv" target="_blank" rel="noopener noreferrer" class="flex items-center link" :class="{'text-blue-600 hover:text-blue-700': !darkMode, 'text-blue-400 hover:text-blue-300': darkMode}">
                          <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                          </svg>
                          IOTM History
                        </a>
                      </li>
                    </ul>
                  </div>
                  
                  <!-- PNG Graphs -->
                  <div class="mb-4">
                    <p class="mb-3" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">
                      <span class="font-medium">Exchange rate history graphs in PNG format:</span>
                    </p>
                    <div class="flex flex-wrap gap-2 text-sm">
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_1mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">1 month</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_3mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">3 months</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_6mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">6 months</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_12mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">1 year</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_24mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">2 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_36mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">3 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_48mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">4 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_60mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">5 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_72mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">6 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_84mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">7 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_96mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">8 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_108mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">9 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_120mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">10 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history_180mo.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">15 years</a>
                      <a href="https://kol-exchange-web.s3.amazonaws.com/rate_history.png" class="px-3 py-1 rounded-full transition-colors" :class="{'bg-blue-100 text-blue-700 hover:bg-blue-200': !darkMode, 'bg-blue-900/30 text-blue-300 hover:bg-blue-800/50': darkMode}">All Data</a>
                    </div>
                  </div>
                    
                  <p class="mt-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">
                    A detailed reference for monthly Mr. Store offerings can be found on the 
                    <a href="https://kol.coldfront.net/thekolwiki/index.php/Mr._Store" target="_blank" rel="noopener noreferrer" class="font-medium underline link" :class="{'text-blue-600': !darkMode, 'text-blue-400': darkMode}">KoL Wiki</a>.
                  </p>
                </div>

                <!-- Neat-o Bonus Section -->
                <div class="section-card rounded-xl p-6" :class="{'bg-white': !darkMode, 'bg-gray-800': darkMode}">
                  <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M5 2a2 2 0 00-2 2v14l3.5-2 3.5 2 3.5-2 3.5 2V4a2 2 0 00-2-2H5zm4.707 3.707a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L8.414 9H10a3 3 0 013 3v1a1 1 0 102 0v-1a5 5 0 00-5-5H8.414l1.293-1.293z" clip-rule="evenodd"></path>
                    </svg>
                    Neat-o Bonus Thingy
                  </h3>
                  <div class="badge-wrapper pl-2">
                    <a href="https://play.google.com/store/apps/details?id=com.nathanatos.kolexchangewidget" target="_blank" rel="noopener noreferrer" class="hover:opacity-90 transition-opacity">
                      <img decoding="async" src="/software/images/google-play-badge.png" border="0" width="135" height="40" class="transform hover:scale-105 transition-transform"/>
                    </a>
                  </div>
                </div>

                <!-- Tools Section -->
                <div class="section-card rounded-xl p-6" :class="{'bg-white': !darkMode, 'bg-gray-800': darkMode}">
                  <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"></path>
                    </svg>
                    Tools
                  </h3>
                  <p class="leading-relaxed" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">
                    I use 
                    <a href="https://kolmafia.us" target="_blank" rel="noopener noreferrer" class="font-medium underline link" :class="{'text-blue-600': !darkMode, 'text-blue-400': darkMode}">Kolmafia</a>
                    to output the exchange rate, and 
                    <a href="https://d3js.org" target="_blank" rel="noopener noreferrer" class="font-medium underline link" :class="{'text-blue-600': !darkMode, 'text-blue-400': darkMode}">D3.js</a>
                    and 
                    <a href="https://matplotlib.org" target="_blank" rel="noopener noreferrer" class="font-medium underline link" :class="{'text-blue-600': !darkMode, 'text-blue-400': darkMode}">Matplotlib</a>
                    to create the history graphs. The back-end processing runs on a variety of AWS services. Visit my 
                    <a href="https://github.com/ncosgray/KoLExchangeData" target="_blank" rel="noopener noreferrer" class="font-medium underline link" :class="{'text-blue-600': !darkMode, 'text-blue-400': darkMode}">GitHub repo</a>
                    to learn more.
                  </p>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>
      
      <!-- Privacy Page -->
      <a href="#privacy"></a>
      <div x-show="page === 'privacy'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="page-transition">
        <div class="max-w-3xl mx-auto">
          <h1 class="text-3xl font-bold mb-6" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">Privacy Policy</h1>
          <div class="rounded-xl shadow-sm p-6 md:p-8" :class="{'bg-white border border-gray-100': !darkMode, 'bg-gray-800 border border-gray-700': darkMode}">
            <p class="mb-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">
              <em>Last Updated: 19 November, 2023</em>
            </p>
            <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                <strong>Purpose</strong>
            </h3>
            <p class="mb-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">I, Nathan Cosgray, built the Cuppa family of apps as simple open-source utilities, and I distribute them via app stores, GitHub, and direct download from my website, www.nathanatos.com. These apps are provided by me at no cost and are provided for use as is. The purpose of this Privacy Policy web page is to inform visitors and app users of my policies related to the collection, use, and disclosure of the personal information of anyone using my apps.</p>
            <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                <strong>Information Collection and Use</strong>
            </h3>
            <p class="mb-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">Below is a summary of how information is collected and used by the Cuppa app for each platform.</p>
            <ul class="ml-5 space-y-2 list-disc privacy-list">
                <li>
                    <strong>Cuppa for Android</strong>
                    includes an opt-in option to collect timer usage statistics. Stats collection is disabled by default. If you enable stats collection, Cuppa will record basic information about your timer usage, including the name and settings of each tea, along with the date and time when you start a tea timer. You will then have access to a simple report summarizing your tea drinking habits. Timer usage stats data is only saved locally on your device, but may be also included in device backups (depending on your operating system settings). No personally identifiable data or location information is stored by Cuppa at any time.
                </li>
                <li>
                    <strong>Cuppa for iOS</strong>
                    includes an opt-in option to collect timer usage statistics. Stats collection is disabled by default. If you enable stats collection, Cuppa will record basic information about your timer usage, including the name and settings of each tea, along with the date and time when you start a tea timer. You will then have access to a simple report summarizing your tea drinking habits. Timer usage stats data is only saved locally on your device, but may be also included in device backups (depending on your operating system settings). No personally identifiable data or location information is stored by Cuppa at any time.
                </li>
                <li>
                    <strong>Cuppa for macOS</strong>
                    does not knowingly collect, store, use, or share the personal information of any user, of any age, for any purpose.
                </li>
            </ul>
            <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                <strong>Log Data</strong>
            </h3>
            <p class="mb-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">Below is a summary of any activity that is logged by the Cuppa app for each platform. Logging includes actions that are recorded by the app or app-related services for tracking user activity, measuring user activity, or any other purpose.</p>
            <ul class="ml-5 space-y-2 list-disc privacy-list">
                <li>
                    <strong>Cuppa for Android</strong>
                    does not generate any log data if timer usage statistics is disabled. If timer usage statistics is enabled, the following data is recorded every time a tea timer is started: tea name, steep time, brewing temperature, tea color, tea icon, starred status, and timer begin date and time. All data is stored in a database local to the device, and no data is transmitted to external systems. If the user subsequently opts out of stats collection, any previously recorded data is purged.
                </li>
                <li>
                    <strong>Cuppa for iOS</strong>
                    does not generate any log data if timer usage statistics is disabled. If timer usage statistics is enabled, the following data is recorded every time a tea timer is started: tea name, steep time, brewing temperature, tea color, tea icon, starred status, and timer begin date and time. All data is stored in a database local to the device, and no data is transmitted to external systems. If the user subsequently opts out of stats collection, any previously recorded data is purged.
                </li>
                <li>
                    The version of 
                    <strong>Cuppa for macOS distributed via the App Store</strong>
                    does not generate any log data.
                </li>
                <li>
                    The version of 
                    <strong>Cuppa for macOS distributed via direct download from GitHub or my website</strong>
                    uses an updater framework, Sparkle, which, if enabled, accesses an HTTPS-secured URL on my website to periodically check for updates to the app. This feature is called &#8220;Check for Updates&#8221;. Since the update check occurs over the internet, my web server may store some limited log data related to each periodic check originating from your device. This log data may include information such as your devices&#8217;s Internet Protocol (&#8220;IP&#8221;) address, device name, operating system version, version number of the app installed on your device, the time and date of the update check, and other basic statistics. If you wish to opt out, you will be able to do so the first time you launch the Cuppa macOS app. Opting out will not affect your ability to use or download the Cuppa apps.
                </li>
            </ul>
            <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                <strong>Cookies</strong>
            </h3>
            <p class="mb-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">Cookies are files with small amount of data that are commonly used an anonymous unique identifier. These are sent to your browser from the website that you visit and are stored on your device&#8217;s internal memory.</p>
            <ul class="ml-5 space-y-2 list-disc privacy-list">
                <li>
                    <strong>Cuppa for Android</strong>
                    does not use any cookies.
                </li>
                <li>
                    <strong>Cuppa for iOS</strong>
                    does not use any cookies.
                </li>
                <li>
                    <strong>Cuppa for macOS</strong>
                    does not use any cookies.
                </li>
                <li>
                    <strong>www.nathanatos.com</strong>
                    <span style="font-size: revert;"> does not use cookies explicitly. However, the website may set some third-party tracking cookies related to my use of Google Analytics for website usage analytics. You have the option to either accept or refuse these cookies by changing your web browser&#8217;s privacy settings. If you choose to refuse our cookies, that will not affect your ability to use or download the Cuppa apps.</span>
                </li>
            </ul>
            <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                <strong>Children&#8217;s Privacy</strong>
            </h3>
            <p class="mb-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">As stated above, the Cuppa apps do not knowingly collect, store, use, or share the personal information of any user, of any age, for any purpose other than basic timer usage statistics, and no data is transmitted to external systems. If I discover any information about a child under 13 has been inadvertently shared with me, I will immediately purge that information from my systems. Likewise, if you are a parent or guardian and you are aware that your child has provided me with personal information, please contact me, and I will immediately purge that information from my systems.</p>
            <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                <strong>Changes to This Privacy Policy</strong>
            </h3>
            <p class="mb-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">I may update this Privacy Policy from time to time. Changes to my Privacy Policy will only be posted here, and this page will be your only notification that an update has occurred. Thus, you are advised to review this page periodically. When posted here, changes to the policy are effective immediately.</p>
            <h3 class="flex items-center text-lg font-bold mb-4" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">
                <strong>Contact Me</strong>
            </h3>
            <p class="mb-4" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">
                If you have any questions about my Privacy Policy, please use the <strong>Contact</strong> link above to contact me.
            </p>
          </div>
        </div>
      </div>
      
      <!-- Contact Page -->
      <a href="#contact"></a>
      <div x-show="page === 'contact'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" class="page-transition">
        <div class="max-w-3xl mx-auto">
          <h1 class="text-3xl font-bold mb-6" :class="{'text-gray-900': !darkMode, 'text-white': darkMode}">Contact Me</h1>
          <div class="rounded-xl shadow-lg p-6 md:p-8" :class="{'bg-white border border-gray-100': !darkMode, 'bg-gray-800 border border-gray-700': darkMode}">
            <p class="mb-6" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">
              Please use the form below to contact me.
              Fields marked with <span class="text-red-500">*</span> are <span class="font-medium">required</span>.
            </p>
            <form id="fs-frm" name="simple-contact-form" accept-charset="utf-8" action="https://formspree.io/f/xjvqgbaa" method="post" class="space-y-4">
              <fieldset id="fs-frm-inputs" class="space-y-4">
                <div>
                  <label for="full-name" class="block mb-1 font-medium" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">Your full name:</label>
                  <input 
                    type="text" 
                    name="name" 
                    id="full-name" 
                    class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors" 
                    :class="{'border-gray-300 focus:ring-blue-500 focus:border-blue-500': !darkMode, 'border-gray-600 bg-gray-700 text-white focus:ring-blue-400 focus:border-blue-400': darkMode}"
                  />
                </div>
                
                <div>
                  <label for="email-address" class="block mb-1 font-medium" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">
                    Email address: <span class="text-red-500">*</span>
                  </label>
                  <input 
                    type="email" 
                    name="_replyto" 
                    id="email-address" 
                    required 
                    class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors" 
                    :class="{'border-gray-300 focus:ring-blue-500 focus:border-blue-500': !darkMode, 'border-gray-600 bg-gray-700 text-white focus:ring-blue-400 focus:border-blue-400': darkMode}"
                  />
                </div>
                
                <div>
                  <label for="message" class="block mb-1 font-medium" :class="{'text-gray-700': !darkMode, 'text-gray-300': darkMode}">
                    Your comments or questions: <span class="text-red-500">*</span>
                  </label>
                  <textarea 
                    name="message" 
                    id="message" 
                    rows="5" 
                    required 
                    class="w-full px-3 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors" 
                    :class="{'border-gray-300 focus:ring-blue-500 focus:border-blue-500': !darkMode, 'border-gray-600 bg-gray-700 text-white focus:ring-blue-400 focus:border-blue-400': darkMode}"
                  ></textarea>
                </div>
                
                <input type="hidden" name="_subject" id="email-subject" value="Nathanatos.com Web Form Submission"/>
              </fieldset>
              
              <div class="pt-2">
                <button 
                  type="submit" 
                  class="px-5 py-2 font-medium rounded-lg transition-colors focus:outline-none focus:ring-2" 
                  :class="{'bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500': !darkMode, 'bg-blue-500 hover:bg-blue-600 text-white focus:ring-blue-400': darkMode}"
                >
                  Send Message
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </main>
    
    <!-- Footer -->
    <footer class="shadow-sm border-t mt-auto" :class="{'bg-white border-gray-200': !darkMode, 'bg-gray-800 text-white border-gray-700': darkMode}">
      <div class="container mx-auto px-4 py-6">
        <div class="flex flex-col md:flex-row justify-between items-center">
          <p class="text-sm" :class="{'text-gray-600': !darkMode, 'text-gray-400': darkMode}">¬© Nathan Cosgray. All rights reserved.</p>
          <div class="flex space-x-5 mt-4 md:mt-0">
            <a href="https://github.com/ncosgray" target="_blank" class="transition-colors" :class="{'text-gray-500 hover:text-gray-700': !darkMode, 'text-gray-400 hover:text-gray-200': darkMode}">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
              </svg>
            </a>
            <a href="https://www.linkedin.com/in/ncosgray/" class="transition-colors" :class="{'text-gray-500 hover:text-gray-700': !darkMode, 'text-gray-400 hover:text-gray-200': darkMode}">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <script>
    // URLs to external CSV files
    const rateDataUrl = "https://kol-exchange-web.s3.us-east-1.amazonaws.com/mr_accessory_rate_history.csv";
    const itemDataUrl = "https://kol-exchange-web.s3.us-east-1.amazonaws.com/iotm_history.csv";
    
    // Global variables to store data and chart elements
    let rateData, itemData, svg, x, y, line, dots, itemRegions;
    let width, height, margin;
    
    // Function to create the chart
    function createChart(rateData, itemData) {
      /*
      // Find the most recent data point (by date)
      const latestDataPoint = d3.max(rateData, d => d.date);
      const mostRecentRate = rateData.find(d => d.date.getTime() === latestDataPoint.getTime()).rate;
      const mostRecentIOTM = rateData.find(d => d.date.getTime() === latestDataPoint.getTime()).item_name;
      const mostRecentItemType = rateData.find(d => d.date.getTime() === latestDataPoint.getTime()).is_familiar ? "FOTM" : "IOTM";
      formattedDate = `${d3.utcFormat("%e %B %Y")(latestDataPoint)}`;
      formattedRate = `${mostRecentRate.toLocaleString()} Meat = $1 US`;
      formattedItem = `${mostRecentItemType}: ${mostRecentIOTM}`;
        
      // Replace the loading message with today's data
      document.getElementById("chart").innerHTML = `<center><b>${formattedRate}</b><br>
        <font size=-1><i>(as of ${formattedDate})</i></font><br>
        ${formattedItem}</center>`;
      */
      document.getElementById("chart").innerHTML = "";
  
      // Set up dimensions and margins based on the container size
      const chartContainer = document.getElementById("chart").parentElement;
      let width = (chartContainer.clientWidth || 600) * 0.85;
      height = width;
      margin = {
        top: 10,
        right: 10,
        bottom: 60,
        left: 60
      };
      
      // Create SVG
      svg = d3.select("#chart")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);

      // Set up scales
      x = d3.scaleTime()
        .domain(d3.extent(rateData, d => d.date))
        .range([0, width]);
      
      y = d3.scaleLinear()
        .domain([
          d3.min(rateData, d => d.rate) * 0.99, 
          d3.max(rateData, d => d.rate) * 1.01
        ])
        .range([height, 0]);
      
      // Add a group for item regions (added before axes so they appear behind)
      svg.append("g")
        .attr("class", "item-regions-group");
      
      // Add X grid lines
      svg.append("g")
        .attr("class", "grid x-grid")
        .attr("transform", `translate(0,${height})`);
      
      // Add Y grid lines
      svg.append("g")
        .attr("class", "grid y-grid");
      
      // Add X axis
      svg.append("g")
        .attr("class", "x-axis")
        .attr("transform", `translate(0,${height})`);
      
      // Add Y axis
      svg.append("g")
        .attr("class", "y-axis");
      
      // Add Y axis label
      svg.append("text")
        .attr("class", "axis-label")
        .attr("transform", "rotate(-90)")
        .attr("y", -margin.left)
        .attr("x", -height / 2)
        .attr("dy", "1em")
        .style("text-anchor", "middle")
        .text("Exchange Rate (Meat / USD)");
            
      // Create the line
      line = d3.line()
        .x(d => x(d.date))
        .y(d => y(d.rate));
      
      // Add the line path
      svg.append("path")
        .attr("class", "line")
        .datum(rateData);
      
      // Add tooltip div
      const tooltip = d3.select("body").append("div")
        .attr("class", "tooltip");
      
      // Create group for dots
      svg.append("g")
        .attr("class", "dots-group");
      
      // Create group for item labels
      svg.append("g")
        .attr("class", "item-labels-group");
      
      // Create a rect for capturing mouse movement
      const mouseArea = svg.append("rect")
        .attr("class", "overlay")
        .attr("width", width)
        .attr("height", height)
        .on("mousemove", mousemove)
        .on("mouseout", mouseout);
      
      function mousemove(event) {
        const [mouseX] = d3.pointer(event);
        const x0 = x.invert(mouseX);
        
        // Filter visible data based on current domain
        const visibleData = rateData.filter(d => {
          return d.date >= x.domain()[0] && d.date <= x.domain()[1];
        });
        
        if (visibleData.length === 0) return;
        
        // Find the closest data point to the mouse position
        const bisect = d3.bisector(d => d.date).left;
        const i = bisect(visibleData, x0, 1);
        
        // Check if we're at the edge of the data
        if (i === 0 || i >= visibleData.length) {
          return;
        }
        
        const d0 = visibleData[i - 1];
        const d1 = visibleData[i];
        const d = x0 - d0.date > d1.date - x0 ? d1 : d0;
        
        // Update dot visibility
        svg.selectAll(".dot")
          .style("opacity", dot => (dot.date.getTime() === d.date.getTime()) ? 1 : 0);
        
        // Find the current item period
        const currentItem = findItemForDate(d.date);
        const itemInfo = currentItem ? 
          `<br><strong>Item:</strong> ${currentItem.item_name}` +
          `<br><strong>Type:</strong> ${currentItem.is_familiar === 1 ? 'FOTM' : 'IOTM'}` : '';
        
        // Position and show tooltip
        tooltip
          .style("opacity", 0.9)
          .html(`<strong>Date:</strong> ${d3.utcFormat("%e %B %Y")(d.date)}<br>
                 <strong>Rate:</strong> ${d.rate.toLocaleString()}  Meat
                 ${itemInfo}`)
          .style("left", `${event.pageX + 15}px`)
          .style("top", `${event.pageY - 30}px`);
      }
      
      function mouseout() {
        svg.selectAll(".dot").style("opacity", 0);
        tooltip.style("opacity", 0);
      }
      
      // Function to find which item period a date falls into
      function findItemForDate(date) {
        for (let i = 0; i < itemData.length; i++) {
          const currentItemDate = itemData[i].date;
          const nextItemDate = i < itemData.length - 1 ? itemData[i + 1].date : new Date(8640000000000000); // Far future date
          
          if (date >= currentItemDate && date < nextItemDate) {
            return itemData[i];
          }
        }
        return null;
      }
      
      // Initialize with "3 Month" view by default
      updateChart("3");
      
      // Set up zoom buttons
      d3.selectAll(".zoom-btn").on("click", function() {
        d3.selectAll(".zoom-btn").classed("active", false);
        d3.select(this).classed("active", true);

        const months = d3.select(this).attr("data-months");
        updateChart(months);
      });
    }
    
    // Function to update the chart based on zoom level
    function updateChart(monthsStr) {
      // Calculate new domain based on selected time period
      let startDate, endDate;
      
      if (monthsStr === "all") {
        // Show all data
        startDate = d3.min(rateData, d => d.date);
        endDate = d3.max(rateData, d => d.date);
      } else {
        // Show specified months of data
        const months = parseInt(monthsStr);
        endDate = d3.max(rateData, d => d.date);
        startDate = new Date(endDate);
        startDate.setMonth(startDate.getMonth() - months);
        startDate.setDate(1);
      }

      // Reset time components to midnight UTC to match parsed CSV dates
      startDate = new Date(Date.UTC(
        startDate.getFullYear(), 
        startDate.getMonth(), 
        startDate.getDate(), 
        0, 0, 0, 0
      ));
      
      // Update x scale domain
      x.domain([startDate, endDate]);
      
      // Filter visible data
      const visibleRateData = rateData.filter(d => {
        return d.date >= startDate && d.date <= endDate;
      });
      
      // Update y scale domain based on visible data
      if (visibleRateData.length > 0) {
        y.domain([
          d3.min(visibleRateData, d => d.rate) * 0.99,
          d3.max(visibleRateData, d => d.rate) * 1.05
        ]);
      }
      
      // Update X grid lines
      svg.select(".x-grid")
        .call(d3.axisBottom(x)
          .ticks(10)
          .tickSize(-height)
          .tickFormat("")
        );
      
      // Update Y grid lines
      svg.select(".y-grid")
        .call(d3.axisLeft(y)
          .ticks(10)
          .tickSize(-width)
          .tickFormat("")
        );
      
      // Update X axis
      svg.select(".x-axis")
        .call(d3.axisBottom(x).tickFormat(d3.utcFormat("%e %b %Y")))
        .selectAll("text")
        .style("text-anchor", "end")
        .attr("dx", "-.8em")
        .attr("dy", ".15em")
        .attr("transform", "rotate(-45)");
      
      // Update Y axis with custom formatting for large numbers
      svg.select(".y-axis")
        .call(d3.axisLeft(y).tickFormat(d => {
          // Format large numbers with abbreviations
          if (d >= 1000000) {
            return (d / 1000000).toFixed(1) + "M";
          } else if (d >= 1000) {
            return (d / 1000).toFixed(1) + "K";
          } else {
            return d.toFixed(0);
          }
        }));
      
      // Update line
      svg.select(".line")
        .datum(visibleRateData)
        .attr("d", line);
      
      // Update or create dots
      const dotsGroup = svg.select(".dots-group");
      dotsGroup.selectAll(".dot").remove();
      
      dots = dotsGroup.selectAll(".dot")
        .data(visibleRateData)
        .enter()
        .append("circle")
        .attr("class", "dot")
        .attr("r", 5)
        .attr("cx", d => x(d.date))
        .attr("cy", d => y(d.rate))
        .style("opacity", 0);
      
      // Update or create item regions
      updateItemRegions(startDate, endDate);

      // Color the chart elements based on dark mode
      if (isDarkMode) {
        d3.selectAll(".zoom-btn").classed("dark", true);
        d3.selectAll(".axis-label").classed("dark", true);
      } else {
        d3.selectAll(".zoom-btn").classed("dark", false);
        d3.selectAll(".axis-label").classed("dark", false);
      }
    }
    
    // Function to update item regions and labels
    function updateItemRegions(startDate, endDate) {
      const regionsGroup = svg.select(".item-regions-group");
      const labelsGroup = svg.select(".item-labels-group");
      
      // Remove existing regions and labels
      regionsGroup.selectAll(".item-region").remove();
      labelsGroup.selectAll(".item-label").remove();
      
      // Filter items visible in the current view
      const visibleItems = [];
      
      // Create item periods (from one item introduction to the next)
      for (let i = 0; i < itemData.length; i++) {
        const currentItem = itemData[i];
        const nextItem = i < itemData.length - 1 ? itemData[i + 1] : null;
        
        let regionStart = currentItem.date;
        let regionEnd = nextItem ? nextItem.date : new Date(8640000000000000); // Far future date
        
        // Skip if region is completely outside current view
        if (regionEnd < startDate || regionStart > endDate) continue;
        
        // Clip region to current view
        regionStart = regionStart < startDate ? startDate : regionStart;
        regionEnd = regionEnd > endDate ? endDate : regionEnd;
        
        // Alternate coloring - add index info
        visibleItems.push({
          item: currentItem,
          start: regionStart,
          end: regionEnd,
          index: i  // Used for alternating colors
        });
      }
      
      // Add regions with alternating colors
      regionsGroup.selectAll(".item-region")
        .data(visibleItems)
        .enter()
        .append("rect")
        .attr("class", d => {
          // Alternating color scheme based on index
          const colorClass = d.index % 2 === 0 ? 'color-a' : 'color-b';
          // Add familiar class if applicable
          return `item-region ${colorClass} ${d.item.is_familiar === 1 ? 'familiar' : ''}`;
        })
        .attr("x", d => x(d.start))
        .attr("y", 0)
        .attr("width", d => Math.max(1, x(d.end) - x(d.start))) // Ensure minimum width of 1px
        .attr("height", height);
      
      // Add multi-line labels
      labelsGroup.selectAll(".item-label")
        .data(visibleItems)
        .enter()
        .append("text")
        .attr("class", "item-label")
        .attr("x", d => x(d.start) + (x(d.end) - x(d.start)) / 2)
        .attr("y", 2)
        .attr("text-anchor", "middle")
        .style("display", function(d) {
          // Hide labels that are too narrow
          const width = x(d.end) - x(d.start);
          return width < 26 ? "none" : null;
        })
        .each(function(d) {
          const text = d3.select(this);
          const name = d.item.item_name;
          const regionWidth = x(d.end) - x(d.start);
          
          // Calculate how many characters we can fit per line
          // Rough estimate: 5 pixels per character
          const charsPerLine = Math.floor(regionWidth / 5);
          
          if (name.length <= charsPerLine) {
            // If name fits, show in one line
            text.append("tspan")
              .attr("x", d3.select(this).attr("x"))
              .attr("dy", "0.9em")
              .text(name);
          } else {
            // Split into multiple lines
            const words = name.split(' ');
            let line = '';
            let lineNumber = 0;

            for (let i = 0; i < words.length; i++) {
              // If the word itself is too long, truncate it
              if (words[i].length > charsPerLine) {
                words[i] = words[i].substring(0, charsPerLine - 3) + '... ';
              }

              let testLine = line + words[i] + ' ';
              
              // If adding another word exceeds the line length
              if (testLine.length > charsPerLine) {
                // If this is not the first word of the line, add the current line
                if (line !== '') {
                  text.append("tspan")
                  .attr("x", d3.select(this).attr("x"))
                  .attr("dy", lineNumber === 0 ? "0.9em" : "1.1em")
                  .text(line.trim());

                  lineNumber++;
                }
                
                // Move to the next line
                line = words[i] + ' ';
              } else {
                line = testLine;
              }
            }

            // Append the last line if any remaining
            if (line !== '') {
              text.append("tspan")
              .attr("x", d3.select(this).attr("x"))
              .attr("dy", lineNumber === 0 ? "0.9em" : "1.1em")
              .text(line.trim());
            }
          }
      });
    }
    
    // Function to load both datasets
    function loadData() {
      Promise.all([
        d3.csv(rateDataUrl),
        d3.csv(itemDataUrl)
      ]).then(function(results) {
        // Define a UTC date parser
        const parseDate = d3.utcParse("%Y-%m-%d");

        // Parse the rate data
        rateData = results[0].map(d => {
          return {
            date: parseDate(d.date.substring(0, 10)),
            rate: +d.rate,
            item_name: d.iotm_name,
            is_familiar: +d.iotm_is_familiar // Convert to number (1 = familiar, other = regular)
          };
        }).sort((a, b) => a.date - b.date); // Ensure dates are sorted
        
        // Parse the item data
        itemData = results[1].map(d => {
          return {
            date: parseDate(d.date.substring(0, 10)),
            item: d.item,
            item_name: d.iotm_name,
            is_familiar: +d.iotm_is_familiar // Convert to number (1 = familiar, other = regular)
          };
        }).sort((a, b) => a.date - b.date); // Ensure dates are sorted
        
        // Create the chart with both datasets
        createChart(rateData, itemData);

        // Redraw the chart on window resize
        let lastWidth = window.innerWidth;
        window.addEventListener('resize', function() {
          const currentWidth = window.innerWidth;

          // Only redraw when width changes
          if (currentWidth !== lastWidth) {
            // Clear the previous chart
            document.getElementById("chart").innerHTML = '<div class="loading">Resizing chart...</div>';
            // Redraw with updated dimensions
            setTimeout(function() {
              createChart(rateData, itemData);
            }, 250); // Small delay to prevent constant redraws during resize

            lastWidth = currentWidth;
          }
        });
      }).catch(function(error) {
        // Handle any errors that occur during loading
        console.error("Error loading the data:", error);
        document.getElementById("chart").innerHTML = 
          `<div class="error">
            <p>Error loading data. Please try again later.</p>
          </div>`;
      });
    }

    // Determine if dark mode is enabled
    function isDarkMode() {
      // Get the component by selector
      const component = document.querySelector('[x-data]').__x;
      return component.$data.darkMode;
    }
    
    // Start loading the data
    loadData();
  </script>
</body>
</html>
